name: Gentoo Desktop OpenRC AMD64

on:
  push:
    branches: [master]

jobs:
  gentoo-job:
    runs-on: ubuntu-latest  # GitHub Actions host runner
    container:
      image: gentoo/stage3:desktop  # Pulls the Gentoo image from Docker Hub
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
      - name: Sync and add overlay
        run: |
          emerge --sync || exit
          emerge app-eselect/eselect-repository || exit
          eselect repository add untitled-desktop-overlay git https://github.com/MadLadSquad/UntitledDesktopOverlay.git || exit
          emerge --sync untitled-desktop-overlay || exit
      - name: Configure use flags
        run: |
          emerge flaggie
          flaggie raft +lz4
          flaggie xdelta +lzma
          flaggie squashfs-tools +lzma
          flaggie libcap +static-libs
      - name: Install applications
        run: |
          emerge untitled-ibus-handwriting untitled-game-system-manager ude-session-logout || exit
        
    
